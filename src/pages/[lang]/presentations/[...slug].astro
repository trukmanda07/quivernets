---
/**
 * Dynamic Presentation Route (reveal.js version)
 * Handles all presentations with language support
 * Routes: /{lang}/presentations/{slug}
 *
 * NEW: Loads presentations from file-based structure
 * src/content/presentations-{lang}/{slug}/
 */

import RevealLayout from '../../../layouts/RevealLayout.astro';
import RevealPresentation from '../../../components/RevealPresentation.astro';
import { getAllPresentationSlugs, loadPresentation } from '../../../utils/loadPresentation';

export async function getStaticPaths() {
  const paths = [];
  const languages = ['en', 'id'];

  // Generate paths for all presentations in all languages
  for (const lang of languages) {
    const slugs = getAllPresentationSlugs(lang);

    for (const slug of slugs) {
      // Load presentation data from file structure
      const { metadata, slides } = loadPresentation(slug, lang);

      paths.push({
        params: { lang, slug },
        props: { metadata, slides, lang, slug }
      });
    }
  }

  return paths;
}

interface Props {
  metadata: any;
  slides: any[];
  lang: string;
  slug: string;
}

const { metadata, slides, lang, slug } = Astro.props;
---

<RevealLayout
  title={metadata.title}
  description={metadata.description}
  language={lang}
  theme="custom"
>
  <RevealPresentation
    title={metadata.title}
    slides={slides}
    relatedBlogPost={metadata.relatedBlogPost}
    language={lang}
    displayMode="instagram"
    slug={slug}
  />
</RevealLayout>
